<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="partyBoard-mapper">

	<insert id="insertParty" parameterType="PartyBoard">
		INSERT INTO PARTYBOARD VALUES
		(SEQ_PB.NEXTVAL,#{pbTimer},#{pbRanktype},#{pbTier},#{pbPosition},#{pbContent},#{pbUser},#{pbVoice},SYSDATE,#{epoch})

	</insert>

	<select id="selectListParty" resultType="PartyBoard">
		SELECT * FROM PARTYBOARD
    	ORDER BY PBDATE DESC
	</select>
	
	
	<select id="totalCountContent" resultType="int">
		SELECT COUNT(*) FROM PARTYBOARD
	</select>
	
	
	<select id="indexPartyBoardList" resultType="PartyBoard">
	 <![CDATA[
      SELECT * FROM(SELECT * FROM PARTYBOARD ORDER BY EPOCH DESC)
        WHERE ROWNUM <= 4
   ]]>
	</select>
	
<!-- 검색용 쿼리 -->	
	<select id="searchList" resultType="PartyBoard">
		SELECT * FROM PARTYBOARD
		<where>
		<choose>
			<when test="pbRanktype != '모든 큐'">
				PBRANKTYPE = #{pbRanktype}
			</when>
			<otherwise>
				(PBRANKTYPE='솔로랭크' OR PBRANKTYPE='자유랭크' 
				OR PBRANKTYPE='칼바람' OR PBRANKTYPE='일반')
			</otherwise>
		</choose>
		
		<choose>
			<when test="pbTier != '티어 상관없이'">
				AND PBTIER = #{pbTier}
			</when>
			<otherwise>
				AND (PBTIER='티어 상관없이' OR PBTIER='언랭 이상' 
					OR PBTIER='아이언 이상' OR PBTIER='브론즈 이상' 
					OR PBTIER='실버 이상' OR PBTIER='골드 이상' 
					OR PBTIER='플레 이상' OR PBTIER='다이아 이상' 
					OR PBTIER='마스터 이상' OR PBTIER='그마 이상' OR PBTIER='챌린저')
			</otherwise>
		</choose>

		<choose>
			<when test="pbPosition != '포지션 상관 없이 구함'">
				AND PBPOSITION = #{pbPosition}
			</when>
			<otherwise>
				AND (PBPOSITION='탑 구함' OR PBPOSITION='정글 구함' 
					OR PBPOSITION='미드 구함' OR PBPOSITION='원딜 구함' 
					OR PBPOSITION='서폿 구함' OR PBPOSITION='포지션 상관 없이 구함')
			</otherwise>
			</choose>
			
		</where>
		ORDER BY PBDATE DESC
	</select>
	
	

</mapper>